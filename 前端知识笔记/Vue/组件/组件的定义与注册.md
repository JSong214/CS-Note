---
date: 2025-06-18
tags:
  - Vue
aliases:
  - 组件
---
### 单文件组件（SFC）剖析

单文件组件，即`.vue`文件，是Vue开发体验中的一个标志性特性。它允许我们将一个组件的模板、逻辑和样式封装在同一个文件中，极大地提高了组件的内聚性和可维护性 。

- **`<template>`**: 此部分包含了组件的HTML结构。它是组件的“视图”层，负责定义UI的布局和内容 。
- `<script>`:此部分包含了组件的JavaScript逻辑。在现代Vue开发中，通常**使用`<script setup>`语法**，以便更简洁地使用组合式API 。
- `<style>`:此部分包含了组件的CSS样式。通过添加**`scoped`属性**，可以使样式仅作用于当前组件，从而避免了全局CSS污染的问题。这是一个非常强大的封装特性 。



### 全局注册与局部注册

- **全局注册 (Global Registration)**: 

  通过在应用实例上调用`app.component()`方法进行注册。全局注册的组件可以在应用的任何其他组件模板中直接使用，无需导入 。

  - **优点**: 对于那些在应用中频繁使用的基础组件（如`BaseButton`、`BaseIcon`、`Modal`等）非常方便，可以一次注册，处处使用。这个过程甚至可以自动化，通过脚本批量注册特定目录下的所有基础组件 。
  - **缺点**: 全局注册有两个主要弊端。
    - 首先，它会阻止构建工具进行“摇树优化”（tree-shaking）。即使一个全局组件从未在应用中使用，它仍然会被打包到最终的生产文件中，增大了包体积。
    - 其次，在大型应用中，全局注册会使组件间的依赖关系变得模糊不清，难以从一个父组件追溯其子组件的来源，长期来看会影响项目的可维护性 。

  ```js
  // main.js
  import { createApp } from 'vue'
  import App from './App.vue'
  
  // 1. 导入你的组件
  import BaseButton from './components/BaseButton.vue'
  import BaseCard from './components/BaseCard.vue'
  import BaseIcon from './components/BaseIcon.vue'
  
  const app = createApp(App)
  
  // 2. 使用 app.component()进行全局注册
  // 第一个参数是组件的“标签名”（通常使用 PascalCase 或 kebab-case）
  // 第二个参数是导入的组件对象
  app.component('BaseButton', BaseButton)
  app.component('BaseCard', BaseCard)
  app.component('BaseIcon', BaseIcon)
  
  app.mount('#app')
  ```

  



- **局部注册 (Local Registration)**: 这是**推荐的默认方式**。

  在选项式API中，通过组件的`components`选项来注册。**在`<script setup>`中，这个过程是自动**的：只要在脚本中导入一个组件，它就可以在模板中直接使用 。

  - **优点**: 局部注册将组件的可用性限制在当前组件的作用域内，这使得依赖关系非常明确。
  - **缺点**: 需要在使用它的每个组件中都显式地导入。


- **方式一：在组合式 API (`<script setup>`) 中**

  ```vue
  <script setup>
  // 1. 从文件导入组件
  import UserProfile from './UserProfile.vue'
  import ProductList from './ProductList.vue'
  
  // 在 <script setup> 中，导入后即可直接在模板使用，无需额外配置
  </script>
  
  <template>
    <div>
      <h1>我的页面</h1>
      <UserProfile />
      <hr />
      <ProductList />
    </div>
  </template>
  ```


- 方式二：在选项式 API (Options API) 或普通的 `<script>` 中

  ```vue
  <script>
  // 1. 从文件导入组件
  import UserProfile from './UserProfile.vue'
  import ProductList from './ProductList.vue'
  
  export default {
    // 2. 在 components 选项中注册
    components: {
      // 标签名: 组件对象
      UserProfile: UserProfile,
      ProductList: ProductList // ES6 中 key 和 value 相同时可简写为 ProductList
    }
  }
  </script>
  
  <template>
    <div>
      <h1>我的页面</h1>
      <UserProfile />
      <hr />
      <ProductList />
    </div>
  </template>
  ```


**实践建议**: 默认应始终使用**局部注册**。仅对一小部分真正全局通用、频繁使用的基础组件库采用全局注册策略。