---
date: 2025-06-17
tags:
  - CSS
  - 动画
---
### **关键帧动画 (`@keyframes` + `animation`)**

**定义：** 允许你定义动画在**整个时间序列**中的**关键状态（帧）**。浏览器会自动计算并平滑地补间这些状态之间的变化。


**核心组件：**

- **`@keyframes` 规则：** 定义动画序列。
- **语法：**
  ```css
   @keyframes animationName {
     from { /* 起始状态 (0%) */ }
     to {   /* 结束状态 (100%) */ }
   
     /* 或 */
     0% { /* 起始状态 */ }
     25% { /* ... */ }
     50% { /* ... */ }
     100% { /* 结束状态 */ }
   }
  ```
- **使用百分比** (`0%`, `25%`, `50%`, `100%`) 或关键字 (`from` 等价于 `0%`, `to` 等价于 `100%`) 来指定动画过程中的关键点。
- 在关键帧内指定元素的 CSS 属性值。


- **`animation`**

  -  将定义好的 `@keyframes` 动画应用到元素上，并控制动画的执行方式。
  - **常用子属性：**
    - **`animation-name`：** 指定要应用的 `@keyframes` 动画的名称。(必需)
    - **`animation-duration`：** 指定动画完成一个周期所需的时间（如 `2s`, `500ms`）。(必需，否则无过渡效果)
    - **`animation-timing-function`：** 控制动画的速度曲线，决定变化如何加速/减速。
      -  `ease` (默认，慢快慢)
      - `linear` (匀速) 
      - `ease-in` (慢入) 
      - `ease-out` (慢出) 
      - `ease-in-out` (慢入慢出)
      - `cubic-bezier(n,n,n,n)` (自定义贝塞尔曲线)
      - `steps(n, [start|end])` (分步动画)。
    - **`animation-delay`：** 指定动画开始前的等待时间（如 `1s`, `-500ms`）。
    - **`animation-iteration-count`：** 指定动画播放的次数。
      - **值：** `1` (默认，播放一次), `2`, `infinite` (无限循环)。
    - **`animation-fill-mode`：** 指定动画在**开始前**和**结束后**，元素应如何应用样式。**(非常重要且易忽略)**
      - **值：**
        - `none` (默认)：动画执行前后，元素保持其原始样式（不受 `@keyframes` 影响）。
        - `forwards`：动画完成后，元素保持**最后一帧 (`100%` 或 `to`)** 的样式。
        - `backwards`：在动画延迟 (`animation-delay`) 期间，元素立即应用**第一帧 (`0%` 或 `from`)** 的样式。
        - `both`：同时应用 `forwards` 和 `backwards` 的效果。**（最常用，确保动画状态正确）**
    - **简写语法：** `animation: name duration timing-function delay iteration-count direction fill-mode play-state;`
      - 示例：
        ```css
        .box {
          animation: slideIn 2s ease-in-out 0.5s infinite alternate both;
        }
        ```



### 过度动画**(`transition`)**

**定义：** 用于在元素**从一个状态变化到另一个状态**时（通常是 CSS 属性值改变，如 `:hover`, `:focus`, 类名改变，JS 修改样式），**平滑地**在一段时间内完成这种变化。它关注的是**状态变化的过程**，而不是定义中间序列。

**核心属性：**
- **`transition-property`：** 指定应用过渡效果的 CSS 属性名称。
  - `all` (默认，所有可过渡属性)
  - `none`
  - `,`分隔的属性名列表 (`width`, `opacity`, `background-color`, `transform` 等)。 **(明确指定性能更好)**
- **`transition-duration`：** 指定过渡效果完成所需的时间（如 `0.3s`, `500ms`）。(必需，否则无过渡效果)
- **`transition-timing-function`：** 控制过渡的速度曲线
- **`transition-delay`：** 指定过渡效果开始前的等待时间
- **简写语法：** `transition: property duration timing-function delay;`
  - 示例：
    ```css
    .button {
      background-color: blue;
      transition: background-color 0.3s ease, transform 0.2s ease-out;
    }
    .button:hover {
      background-color: red;
      transform: scale(1.1);
    }
    ```



### **重要知识点 & 最佳实践**

- **性能优化 (极其重要！)：**
  - **优先使用 `transform` 和 `opacity`**，它们通常**不会触发昂贵的布局（Layout）或绘制（Paint）** 过程
  - 避免动画 `height`, `width`, `margin`, `padding`, `top/left` 等会触发重排/重绘的属性。
  - **谨慎使用 `box-shadow`, `border-radius`, `filter`：** 虽然可以动画，但性能消耗相对较大。
  - **减少动画数量和复杂性：** 过多的并发动画会消耗 CPU/GPU 资源。
  - **使用 `steps()` 制作帧动画：** 对于精灵图动画，`steps()` 比 `linear` 更高效。


- **`animation-fill-mode` 深入理解：**
  - 这是控制动画**初始状态**和**最终状态**是否“粘住”的关键属性。
  - `both` 是最常用的，因为它确保：
    - 动画开始前（包括延迟期）应用第一帧 (`0%`) 样式（`backwards` 效果）。
    - 动画结束后保持最后一帧 (`100%`) 样式（`forwards` 效果）。
  - 忘记设置它，常常是动画结束后元素“跳回”原始样式的原因。


- **`steps()` 函数：**
  - 将动画分成 `n` 个等距的步骤。
  - `steps(n, start)`：变化发生在每步的**开始**。视觉上，第一步的变化是立即发生的。
  - `steps(n, end)`：变化发生在每步的**结束**。视觉上，第一步的变化在第一步结束时才发生（更常见）。
  - 示例（打字机效果）：
    ```css
    @keyframes typing {
      from { width: 0 }
    }
    .typewriter {
      overflow: hidden;
      white-space: nowrap;
      animation: typing 4s steps(40, end) forwards; /* 假设40个字符 */
    }
    ```
